{% extends "layout.html" %}

{% block title %}Data Tiket{% endblock %}

{% block content %}
  <style>
        .table-container {
            max-height: 500px;
            overflow-y: auto;
            overflow-x: auto;
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
        }

        .table-container .table {
            width: 100% !important;
            margin-bottom: 0 !important;
        }

        .table-container .thead-dark th {
            position: sticky !important;
            top: 0 !important;
            z-index: 1020 !important;
            background-color: #343a40 !important;
            border-color: #454d55 !important;
        }

        .table-container .table tbody tr:last-child td {
            border-bottom: 1px solid #dee2e6 !important;
        }

        .table-container::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        @media (max-width: 768px) {
            .modal-xl {
                max-width: 95% !important;
            }

            .table-container {
                max-height: 300px;
            }
        }

        .modal-body {
            overflow: hidden !important;
        }
    </style>


 <div class="page-content">
    <section class="section">
        <section class="card">
            <div class="card-header">
                <div class="container-fluid d-flex justify-content-between align-items-center">
                    <h3 class="mb-3">Data Tiket</h3>
                    <a href="{{ url_for('form') }}" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-1"></i> Tambah Data
                    </a>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table id="example" class="table data-table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Tanggal</th>
                                <th>No Tiket</th>
                                <th>Customer</th>
                                <th>Model</th>
                                <th>Keluhan</th>
                                <th>Teknisi</th>
                                <th>Indikasi</th>
                                <th>Tindakan</th>
                                <th>Before</th>
                                <th>After</th>
                                <th>Serial</th>
                                <th>Lokasi</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if data is defined and data %}
                            {% for tiket in data %}
                            <tr>
                                <td>{{ loop.index }}</td>
                                <td>{{ tiket.tanggal or "-" }}</td>
                                <td>{{ tiket.no_tiket or "-" }}</td>
                                <td>{{ tiket.customer or "-" }}</td>
                                <td>{{ tiket.model or "-" }}</td>
                                <td>{{ tiket.keluhan or "-" }}</td>
                                <td>{{ tiket.teknisi or "-" }}</td>
                                <td>{{ tiket.indikasi or "-" }}</td>
                                <td>{{ tiket.tindakan or "-" }}</td>
                                <td>
                                    {% if tiket.before %}
                                    <a href="/public/{{ tiket.before }}" target="_blank"
                                        class="btn btn-sm btn-primary">Lihat</a>
                                    {% else %}<span class="text-muted">-</span>{% endif %}
                                </td>
                                <td>
                                    {% if tiket.after %}
                                    <a href="/public/{{ tiket.after }}" target="_blank"
                                        class="btn btn-sm btn-primary">Lihat</a>
                                    {% else %}<span class="text-muted">-</span>{% endif %}
                                </td>
                                <td>
                                    {% if tiket.serial_number %}
                                    <a href="/public/{{ tiket.serial_number }}" target="_blank"
                                        class="btn btn-sm btn-primary">Lihat</a>
                                    {% else %}<span class="text-muted">-</span>{% endif %}
                                </td>
                                <td>
                                    {% if tiket.lokasi %}
                                    <a href="/public/{{ tiket.lokasi }}" target="_blank"
                                        class="btn btn-sm btn-primary">Lihat</a>
                                    {% else %}<span class="text-muted">-</span>{% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="13" class="text-center text-muted py-4">
                                    <i class="bi bi-search display-4 d-block mb-2"></i>
                                    <h4>Data Tidak Ditemukan</h4>
                                    <p>Belum ada data tiket dalam sistem</p>
                                </td>
                            </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>

        </section>
    </div>
</div>
{% endblock %}